# 前端網頁細部設計規劃說明書

## 專案概述

本文檔基於 PROJECT_OVERVIEW.md 和完美 Proxy Manager 設計方案，詳細規劃代理管理系統的前端界面設計。系統採用 VS Code 風格的現代化界面，提供直觀的代理管理、監控和分析功能。

## 設計理念

### 核心設計原則

1. **VS Code 風格一致性**: 採用 VS Code 的五區域佈局（Header、Activity Bar、Primary Sidebar、Main Content、Status Bar）
2. **響應式設計**: 支援桌面、平板和行動裝置的最佳體驗
3. **資訊架構清晰**: 功能模組化，導航直觀
4. **即時性**: 提供即時的代理狀態監控和性能指標
5. **可訪問性**: 遵循 WCAG 2.1 AA 標準

### 視覺設計語言

- **色彩系統**: 支援明亮/暗黑雙主題
- **字體**: 系統字體堆疊，確保跨平台一致性
- **圖標**: 使用 VS Code Icons 或 Lucide Icons
- **間距**: 8px 基礎網格系統
- **動效**: 200-300ms 的流暢過渡動畫

## 技術架構

### 前端技術棧

```typescript
// 核心框架
React 18+ with TypeScript
Vite (建置工具)
Tailwind CSS (樣式框架)

// 狀態管理
Zustand (輕量級狀態管理)
TanStack Query (伺服器狀態管理)

// UI 組件庫
Radix UI (無樣式組件基礎)
Lucide React (圖標庫)
Recharts (圖表庫)

// 工具庫
date-fns (日期處理)
clsx (條件樣式)
react-hook-form (表單處理)
zod (資料驗證)
```

### 專案結構

```
frontend/
├── src/
│   ├── components/          # 可重用組件
│   │   ├── ui/             # 基礎 UI 組件
│   │   ├── layout/         # 佈局組件
│   │   ├── charts/         # 圖表組件
│   │   └── forms/          # 表單組件
│   ├── pages/              # 頁面組件
│   │   ├── dashboard/      # 總覽頁面
│   │   ├── proxy-manager/  # 代理管理
│   │   ├── crawler-tasks/  # 爬蟲任務
│   │   ├── analytics/      # 數據分析
│   │   └── settings/       # 系統設置
│   ├── hooks/              # 自定義 Hooks
│   ├── stores/             # 狀態管理
│   ├── services/           # API 服務
│   ├── types/              # TypeScript 類型定義
│   ├── utils/              # 工具函數
│   └── styles/             # 全局樣式
├── public/                 # 靜態資源
└── docs/                   # 組件文檔
```

## 界面佈局設計

### 全局佈局（Desktop ≥ 1200px）

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ Header (48px)                                                               │
│ [≡] [Proxy Manager] [🔍 搜尋] [工作區▾] [🔔] [👤] [🟢 系統狀態]              │
├──┬────────────────────────────────────────────────────────────────────────┤
│  │ Main Content Area                                                      │
│A │ ┌─────────────────────────────────────────────────────────────────────┐ │
│c │ │ Tab Navigation                                                      │ │
│t │ │ [總覽] [代理池] [任務管理] [分析報告] [設置]                          │ │
│i │ ├─────────────────────────────────────────────────────────────────────┤ │
│v │ │                                                                     │ │
│i │ │ Primary Sidebar (250px)    │ Content Area                          │ │
│t │ │ ┌─────────────────────────┐ │ ┌─────────────────────────────────────┐ │ │
│y │ │ │ 動態導航/過濾器          │ │ │ 表格/圖表/表單                       │ │ │
│  │ │ │ • 代理池列表            │ │ │                                     │ │ │
│B │ │ │ • 質量分析              │ │ │                                     │ │ │
│a │ │ │ • 地理分佈              │ │ │                                     │ │ │
│r │ │ │ • 實時檢測              │ │ │                                     │ │ │
│  │ │ │ • 分類標籤              │ │ │                                     │ │ │
│4 │ │ │                         │ │ │                                     │ │ │
│8 │ │ │ [快速過濾] [批量操作]    │ │ │                                     │ │ │
│p │ │ └─────────────────────────┘ │ └─────────────────────────────────────┘ │ │
│x │ └─────────────────────────────────────────────────────────────────────┘ │
├──┴────────────────────────────────────────────────────────────────────────┤
│ Status Bar (22px)                                                          │
│ [🟢 連線] [⚡ CPU: 45%] [💾 記憶體: 2.1GB] │ [同步中...] │ [代理:1,243] [v1.2.0] │
└─────────────────────────────────────────────────────────────────────────────┘
```

### Activity Bar 功能模組

```typescript
interface ActivityBarItem {
  id: string;
  icon: string;
  label: string;
  shortcut: string;
  badge?: number;
}

const activityBarItems: ActivityBarItem[] = [
  { id: 'dashboard', icon: 'LayoutDashboard', label: '總覽', shortcut: 'Ctrl+1' },
  { id: 'proxy-manager', icon: 'Server', label: '代理管理', shortcut: 'Ctrl+2', badge: 1243 },
  { id: 'crawler-tasks', icon: 'Bot', label: '爬蟲任務', shortcut: 'Ctrl+3', badge: 5 },
  { id: 'analytics', icon: 'BarChart3', label: '數據分析', shortcut: 'Ctrl+4' },
  { id: 'settings', icon: 'Settings', label: '系統設置', shortcut: 'Ctrl+5' }
];
```

## 核心頁面設計

### 1. 總覽頁面 (Dashboard)

#### 佈局結構

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 關鍵指標卡片區域                                                              │
│ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐             │
│ │ 總代理數量   │ │ 可用代理     │ │ 平均延遲     │ │ 成功率       │             │
│ │ 1,243       │ │ 1,156       │ │ 245ms       │ │ 94.2%       │             │
│ │ ↑ +23 今日  │ │ ↑ +15 今日  │ │ ↓ -12ms     │ │ ↑ +1.2%     │             │
│ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘             │
├─────────────────────────────────────────────────────────────────────────────┤
│ 圖表區域                                                                    │
│ ┌─────────────────────────────┐ ┌─────────────────────────────────────────┐ │
│ │ 代理性能趨勢圖 (24小時)      │ │ 地理分佈地圖                             │ │
│ │ [成功率] [延遲] [可用性]     │ │ [美國: 456] [歐洲: 321] [亞洲: 466]      │ │
│ └─────────────────────────────┘ └─────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────────────────┤
│ 即時活動區域                                                                │
│ ┌─────────────────────────────┐ ┌─────────────────────────────────────────┐ │
│ │ 最近任務執行                 │ │ 系統告警                                 │ │
│ │ • 任務A - 完成 (09:15)      │ │ • 代理池 US-West 可用率低於 80%          │ │
│ │ • 任務B - 執行中 (09:12)    │ │ • 檢測到 15 個失效代理                   │ │
│ │ • 任務C - 排隊中 (09:30)    │ │ • 系統記憶體使用率達到 85%               │ │
│ └─────────────────────────────┘ └─────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────┘
```

#### 組件設計

```typescript
// 關鍵指標卡片
interface MetricCardProps {
  title: string;
  value: string | number;
  change: {
    value: string;
    trend: 'up' | 'down' | 'neutral';
    period: string;
  };
  icon: string;
  color: 'blue' | 'green' | 'yellow' | 'red';
}

// 性能趨勢圖
interface PerformanceTrendProps {
  data: {
    timestamp: string;
    successRate: number;
    avgLatency: number;
    availability: number;
  }[];
  timeRange: '1h' | '6h' | '24h' | '7d';
}
```

### 2. 代理管理頁面

#### Primary Sidebar 導航

```
代理管理
├─ 📋 代理池列表
│   ├─ 🔥 熱池 (高性能)
│   ├─ 🌡️ 溫池 (中等性能)
│   ├─ ❄️ 冷池 (低性能)
│   └─ 🚫 黑名單
├─ 📊 質量分析
│   ├─ 📈 性能趨勢
│   ├─ 📉 失效分析
│   └─ 🎯 可用率統計
├─ 🗺️ 地理分佈
│   ├─ 🌍 全球地圖
│   ├─ 📍 區域統計
│   └─ 🚀 延遲熱力圖
├─ ⚡ 實時檢測
│   ├─ 🔄 檢測任務
│   ├─ ⏱️ 檢測歷史
│   └─ ⚙️ 檢測設置
└─ 🏷️ 分類標籤
    ├─ 📝 標籤管理
    ├─ 🔗 自動分類
    └─ 📊 標籤統計
```

#### 代理池列表界面

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 工具列                                                                      │
│ [🔍 搜尋代理] [🏷️ 標籤▾] [🌍 地區▾] [⚡ 質量▾] [📊 批量操作▾] [📤 匯出]      │
├─────────────────────────────────────────────────────────────────────────────┤
│ 代理列表表格                                                                │
│ ┌─┬─────────────┬──────┬────────┬──────────┬──────┬────────┬──────────┬──────┐ │
│ │☐│ IP:Port     │ 協定 │ 匿名等級│ 國家/城市 │ 延遲 │ 可用率 │ 最後檢測 │ 操作 │ │
│ ├─┼─────────────┼──────┼────────┼──────────┼──────┼────────┼──────────┼──────┤ │
│ │☐│ 147.182.x.x │ HTTP │ Elite  │ 🇺🇸 US/SJC│ 120ms│ 98.5%  │ 09:12    │ ⚙️📝🗑️│ │
│ │☐│ 85.214.x.x  │HTTPS │ Anon   │ 🇩🇪 DE/BER│ 210ms│ 86.2%  │ 09:10    │ ⚙️📝🗑️│ │
│ │☐│ 192.168.x.x │SOCKS5│ Trans  │ 🇯🇵 JP/TKY│ 89ms │ 99.1%  │ 09:15    │ ⚙️📝🗑️│ │
│ │...                                                                        │ │
│ └─┴─────────────┴──────┴────────┴──────────┴──────┴────────┴──────────┴──────┘ │
├─────────────────────────────────────────────────────────────────────────────┤
│ 分頁控制                                                                    │
│ [◀ 上一頁] [1] [2] [3] [4] [5] [下一頁 ▶] │ 每頁 50 項 ▾ │ 共 1,243 項      │
└─────────────────────────────────────────────────────────────────────────────┘
```

#### 代理詳情側邊抽屜

```typescript
interface ProxyDetailsDrawerProps {
  proxy: {
    id: string;
    host: string;
    port: number;
    protocol: 'HTTP' | 'HTTPS' | 'SOCKS4' | 'SOCKS5';
    anonymity: 'Transparent' | 'Anonymous' | 'Elite';
    country: string;
    city: string;
    latency: number;
    availability: number;
    lastChecked: string;
    tags: string[];
    performance: {
      successRate: number;
      avgResponseTime: number;
      totalRequests: number;
    };
  };
  onClose: () => void;
  onEdit: (proxy: Proxy) => void;
  onDelete: (proxyId: string) => void;
}
```

### 3. 爬蟲任務頁面

#### 任務調度日曆視圖

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 工具列                                                                      │
│ [📅 日曆] [📋 列表] [📊 統計] │ [➕ 新建任務] [⚙️ 批量操作] [📤 匯出]        │
├─────────────────────────────────────────────────────────────────────────────┤
│ 日曆視圖                                                                    │
│ ┌─────────────────────────────┐ ┌─────────────────────────────────────────┐ │
│ │ ◀ 2025年9月 ▶               │ │ 即將執行的任務                           │ │
│ │ 日 一 二 三 四 五 六         │ │ ┌─────────────────────────────────────┐ │ │
│ │  1  2  3  4  5  6  7        │ │ │ 09:30 - 目標網站A (每15分鐘)         │ │ │
│ │  8  9 10 11 12 13 14        │ │ │ 🟢 執行中                           │ │ │
│ │ 15 16 17 18 19 20 21        │ │ ├─────────────────────────────────────┤ │ │
│ │ 22 23 24 25 26 27 28        │ │ │ 10:00 - 目標網站B (每日)             │ │ │
│ │ 29 30                       │ │ │ ⏳ 等待中                           │ │ │
│ │                             │ │ ├─────────────────────────────────────┤ │ │
│ │ [今日有 5 個任務]            │ │ │ 11:15 - 目標網站C (單次)             │ │ │
│ │ [本週完成 23 個任務]         │ │ │ 📅 已排程                           │ │ │
│ └─────────────────────────────┘ │ └─────────────────────────────────────┘ │ │
└─────────────────────────────────────────────────────────────────────────────┘
```

#### 新建任務表單

```typescript
interface CreateTaskFormData {
  name: string;
  description?: string;
  targetUrl: string;
  schedule: {
    type: 'once' | 'interval' | 'cron';
    value: string;
  };
  proxyPool: string;
  concurrency: number;
  retryCount: number;
  timeout: number;
  headers: Record<string, string>;
  selectors: {
    data: string;
    pagination?: string;
  };
  outputFormat: 'json' | 'csv' | 'markdown';
  notifications: {
    onSuccess: boolean;
    onFailure: boolean;
    email?: string;
    webhook?: string;
  };
}
```

### 4. 數據分析頁面

#### 分析儀表板

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 時間範圍選擇                                                                │
│ [最近1小時] [最近6小時] [最近24小時] [最近7天] [自定義範圍]                  │
├─────────────────────────────────────────────────────────────────────────────┤
│ 性能指標圖表                                                                │
│ ┌─────────────────────────────┐ ┌─────────────────────────────────────────┐ │
│ │ 代理性能趨勢                 │ │ 任務執行統計                             │ │
│ │ [成功率] [平均延遲] [吞吐量] │ │ [成功] [失敗] [超時] [重試]              │ │
│ │                             │ │                                         │ │
│ │ 📈 折線圖                   │ │ 📊 柱狀圖                               │ │
│ └─────────────────────────────┘ └─────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────────────────┤
│ 地理分佈與熱力圖                                                            │
│ ┌─────────────────────────────┐ ┌─────────────────────────────────────────┐ │
│ │ 全球代理分佈地圖             │ │ 延遲熱力圖                               │ │
│ │ 🗺️ 互動式地圖               │ │ 🌡️ 區域延遲分佈                         │ │
│ └─────────────────────────────┘ └─────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────────────────┤
│ 詳細統計表格                                                                │
│ ┌─────────────────────────────────────────────────────────────────────────┐ │
│ │ 代理池 │ 總數 │ 可用 │ 平均延遲 │ 成功率 │ 今日請求 │ 今日成功 │ 趨勢    │ │
│ ├────────┼──────┼──────┼──────────┼────────┼──────────┼──────────┼─────────┤ │
│ │ 熱池   │ 456  │ 445  │ 125ms    │ 97.6%  │ 12,456   │ 12,158   │ 📈 +2.1%│ │
│ │ 溫池   │ 321  │ 298  │ 245ms    │ 92.8%  │ 8,234    │ 7,641    │ 📉 -1.3%│ │
│ │ 冷池   │ 466  │ 413  │ 456ms    │ 88.6%  │ 5,123    │ 4,538    │ 📊 +0.5%│ │
│ └────────┴──────┴──────┴──────────┴────────┴──────────┴──────────┴─────────┘ │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 響應式設計

### 斷點定義

```css
/* Tailwind CSS 斷點 */
.breakpoints {
  sm: 640px;   /* 小型裝置 */
  md: 768px;   /* 平板裝置 */
  lg: 1024px;  /* 小型桌面 */
  xl: 1280px;  /* 大型桌面 */
  2xl: 1536px; /* 超大桌面 */
}
```

### 平板適配 (768px - 1023px)

- Activity Bar: 保留 48px 寬度
- Primary Sidebar: 預設收合，點擊展開為 overlay 模式
- Header: 搜尋框縮短，部分功能收折到選單
- 表格: 隱藏次要欄位，提供橫向滾動

### 行動裝置適配 (< 768px)

- 採用底部導航 Tab 替代 Activity Bar
- Primary Sidebar: 全屏抽屜模式
- Header: 精簡版，僅顯示標題和選單按鈕
- 表格: 卡片式佈局替代表格
- Status Bar: 僅顯示關鍵指標

```typescript
// 行動裝置底部導航
const mobileNavItems = [
  { id: 'dashboard', icon: 'Home', label: '總覽' },
  { id: 'proxy', icon: 'Server', label: '代理' },
  { id: 'tasks', icon: 'Bot', label: '任務' },
  { id: 'analytics', icon: 'BarChart', label: '分析' },
  { id: 'more', icon: 'MoreHorizontal', label: '更多' }
];
```

## 主題系統

### 色彩定義

```css
/* 明亮主題 */
:root {
  --color-background: #ffffff;
  --color-foreground: #0f172a;
  --color-muted: #f8fafc;
  --color-muted-foreground: #64748b;
  --color-border: #e2e8f0;
  --color-primary: #3b82f6;
  --color-primary-foreground: #ffffff;
  --color-secondary: #f1f5f9;
  --color-secondary-foreground: #0f172a;
  --color-accent: #f1f5f9;
  --color-accent-foreground: #0f172a;
  --color-destructive: #ef4444;
  --color-destructive-foreground: #ffffff;
  --color-success: #22c55e;
  --color-warning: #f59e0b;
}

/* 暗黑主題 */
[data-theme="dark"] {
  --color-background: #0f172a;
  --color-foreground: #f8fafc;
  --color-muted: #1e293b;
  --color-muted-foreground: #94a3b8;
  --color-border: #334155;
  --color-primary: #3b82f6;
  --color-primary-foreground: #ffffff;
  --color-secondary: #1e293b;
  --color-secondary-foreground: #f8fafc;
  --color-accent: #1e293b;
  --color-accent-foreground: #f8fafc;
  --color-destructive: #ef4444;
  --color-destructive-foreground: #ffffff;
  --color-success: #22c55e;
  --color-warning: #f59e0b;
}
```

### 主題切換組件

```typescript
interface ThemeToggleProps {
  className?: string;
}

const ThemeToggle: React.FC<ThemeToggleProps> = ({ className }) => {
  const [theme, setTheme] = useState<'light' | 'dark'>('light');
  
  const toggleTheme = () => {
    const newTheme = theme === 'light' ? 'dark' : 'light';
    setTheme(newTheme);
    document.documentElement.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
  };
  
  return (
    <button
      onClick={toggleTheme}
      className={cn(
        "flex items-center justify-center w-9 h-9 rounded-md",
        "hover:bg-accent transition-colors",
        className
      )}
      aria-label="切換主題"
    >
      {theme === 'light' ? <Moon size={16} /> : <Sun size={16} />}
    </button>
  );
};
```

## 國際化支援

### 語言配置

```typescript
// i18n 配置
const locales = {
  'zh-TW': {
    name: '繁體中文',
    flag: '🇹🇼'
  },
  'zh-CN': {
    name: '简体中文',
    flag: '🇨🇳'
  },
  'en-US': {
    name: 'English',
    flag: '🇺🇸'
  },
  'ja-JP': {
    name: '日本語',
    flag: '🇯🇵'
  }
};

// 翻譯鍵值
const translations = {
  'zh-TW': {
    'nav.dashboard': '總覽',
    'nav.proxy-manager': '代理管理',
    'nav.crawler-tasks': '爬蟲任務',
    'nav.analytics': '數據分析',
    'nav.settings': '系統設置',
    'proxy.status.active': '活躍',
    'proxy.status.inactive': '非活躍',
    'proxy.status.error': '錯誤',
    'task.status.running': '執行中',
    'task.status.completed': '已完成',
    'task.status.failed': '失敗'
  },
  'en-US': {
    'nav.dashboard': 'Dashboard',
    'nav.proxy-manager': 'Proxy Manager',
    'nav.crawler-tasks': 'Crawler Tasks',
    'nav.analytics': 'Analytics',
    'nav.settings': 'Settings',
    'proxy.status.active': 'Active',
    'proxy.status.inactive': 'Inactive',
    'proxy.status.error': 'Error',
    'task.status.running': 'Running',
    'task.status.completed': 'Completed',
    'task.status.failed': 'Failed'
  }
};
```

## 性能優化

### 代碼分割

```typescript
// 路由層級的代碼分割
const Dashboard = lazy(() => import('../pages/Dashboard'));
const ProxyManager = lazy(() => import('../pages/ProxyManager'));
const CrawlerTasks = lazy(() => import('../pages/CrawlerTasks'));
const Analytics = lazy(() => import('../pages/Analytics'));
const Settings = lazy(() => import('../pages/Settings'));

// 組件層級的代碼分割
const ProxyDetailsDrawer = lazy(() => import('../components/ProxyDetailsDrawer'));
const TaskFormModal = lazy(() => import('../components/TaskFormModal'));
```

### 虛擬化列表

```typescript
// 大量數據的虛擬化渲染
import { FixedSizeList as List } from 'react-window';

interface VirtualizedProxyListProps {
  proxies: Proxy[];
  height: number;
  itemHeight: number;
}

const VirtualizedProxyList: React.FC<VirtualizedProxyListProps> = ({
  proxies,
  height,
  itemHeight
}) => {
  const Row = ({ index, style }: { index: number; style: React.CSSProperties }) => (
    <div style={style}>
      <ProxyListItem proxy={proxies[index]} />
    </div>
  );
  
  return (
    <List
      height={height}
      itemCount={proxies.length}
      itemSize={itemHeight}
      width="100%"
    >
      {Row}
    </List>
  );
};
```

### 圖片優化

```typescript
// 響應式圖片組件
interface OptimizedImageProps {
  src: string;
  alt: string;
  width?: number;
  height?: number;
  className?: string;
}

const OptimizedImage: React.FC<OptimizedImageProps> = ({
  src,
  alt,
  width,
  height,
  className
}) => {
  return (
    <img
      src={src}
      alt={alt}
      width={width}
      height={height}
      className={className}
      loading="lazy"
      decoding="async"
    />
  );
};
```

## 可訪問性 (Accessibility)

### ARIA 標籤

```typescript
// 可訪問的按鈕組件
interface AccessibleButtonProps {
  children: React.ReactNode;
  onClick: () => void;
  disabled?: boolean;
  ariaLabel?: string;
  ariaDescribedBy?: string;
}

const AccessibleButton: React.FC<AccessibleButtonProps> = ({
  children,
  onClick,
  disabled = false,
  ariaLabel,
  ariaDescribedBy
}) => {
  return (
    <button
      onClick={onClick}
      disabled={disabled}
      aria-label={ariaLabel}
      aria-describedby={ariaDescribedBy}
      className="focus:outline-none focus:ring-2 focus:ring-primary"
    >
      {children}
    </button>
  );
};
```

### 鍵盤導航

```typescript
// 鍵盤快捷鍵處理
const useKeyboardShortcuts = () => {
  useEffect(() => {
    const handleKeyDown = (event: KeyboardEvent) => {
      if (event.ctrlKey || event.metaKey) {
        switch (event.key) {
          case '1':
            event.preventDefault();
            // 切換到總覽頁面
            break;
          case '2':
            event.preventDefault();
            // 切換到代理管理頁面
            break;
          case 'b':
            event.preventDefault();
            // 切換側邊欄
            break;
          case '/':
            event.preventDefault();
            // 聚焦搜尋框
            break;
        }
      }
    };
    
    document.addEventListener('keydown', handleKeyDown);
    return () => document.removeEventListener('keydown', handleKeyDown);
  }, []);
};
```

## 測試策略

### 單元測試

```typescript
// 組件測試範例
import { render, screen, fireEvent } from '@testing-library/react';
import { ProxyListItem } from '../ProxyListItem';

describe('ProxyListItem', () => {
  const mockProxy = {
    id: '1',
    host: '192.168.1.1',
    port: 8080,
    protocol: 'HTTP',
    anonymity: 'Elite',
    country: 'US',
    latency: 120,
    availability: 98.5
  };
  
  it('renders proxy information correctly', () => {
    render(<ProxyListItem proxy={mockProxy} />);
    
    expect(screen.getByText('192.168.1.1:8080')).toBeInTheDocument();
    expect(screen.getByText('HTTP')).toBeInTheDocument();
    expect(screen.getByText('Elite')).toBeInTheDocument();
    expect(screen.getByText('120ms')).toBeInTheDocument();
  });
  
  it('calls onEdit when edit button is clicked', () => {
    const mockOnEdit = jest.fn();
    render(<ProxyListItem proxy={mockProxy} onEdit={mockOnEdit} />);
    
    fireEvent.click(screen.getByRole('button', { name: /編輯/i }));
    expect(mockOnEdit).toHaveBeenCalledWith(mockProxy);
  });
});
```

### E2E 測試

```typescript
// Playwright E2E 測試
import { test, expect } from '@playwright/test';

test('proxy management workflow', async ({ page }) => {
  await page.goto('/proxy-manager');
  
  // 檢查頁面載入
  await expect(page.locator('h1')).toContainText('代理管理');
  
  // 搜尋代理
  await page.fill('[placeholder="搜尋代理"]', '192.168');
  await page.press('[placeholder="搜尋代理"]', 'Enter');
  
  // 檢查搜尋結果
  await expect(page.locator('table tbody tr')).toHaveCount(5);
  
  // 編輯代理
  await page.click('table tbody tr:first-child button[aria-label="編輯"]');
  await expect(page.locator('[role="dialog"]')).toBeVisible();
  
  // 更新代理標籤
  await page.fill('[name="tags"]', 'high-performance');
  await page.click('button[type="submit"]');
  
  // 檢查更新成功
  await expect(page.locator('.toast')).toContainText('代理更新成功');
});
```

## 部署配置

### Vite 建置配置

```typescript
// vite.config.ts
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import path from 'path';

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
      '@/components': path.resolve(__dirname, './src/components'),
      '@/pages': path.resolve(__dirname, './src/pages'),
      '@/hooks': path.resolve(__dirname, './src/hooks'),
      '@/utils': path.resolve(__dirname, './src/utils'),
      '@/types': path.resolve(__dirname, './src/types')
    }
  },
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['react', 'react-dom'],
          ui: ['@radix-ui/react-dialog', '@radix-ui/react-dropdown-menu'],
          charts: ['recharts'],
          utils: ['date-fns', 'clsx']
        }
      }
    },
    sourcemap: true,
    minify: 'terser'
  },
  server: {
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:8000',
        changeOrigin: true
      }
    }
  }
});
```

### Docker 配置

```dockerfile
# Dockerfile
FROM node:18-alpine AS builder

WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/nginx.conf

EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

```nginx
# nginx.conf
server {
    listen 80;
    server_name localhost;
    root /usr/share/nginx/html;
    index index.html;
    
    # SPA 路由支援
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # API 代理
    location /api/ {
        proxy_pass http://backend:8000/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
    
    # 靜態資源快取
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

## 開發工作流程

### Git 工作流程

```bash
# 功能開發分支
git checkout -b feature/proxy-management-ui
git add .
git commit -m "feat(ui): implement proxy management interface"
git push origin feature/proxy-management-ui

# 建立 Pull Request
# 代碼審查
# 合併到 main 分支
```

### 代碼品質檢查

```json
// package.json scripts
{
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview",
    "lint": "eslint src --ext ts,tsx --report-unused-disable-directives --max-warnings 0",
    "lint:fix": "eslint src --ext ts,tsx --fix",
    "format": "prettier --write src/**/*.{ts,tsx,css,md}",
    "type-check": "tsc --noEmit",
    "test": "vitest",
    "test:ui": "vitest --ui",
    "test:coverage": "vitest --coverage",
    "e2e": "playwright test",
    "e2e:ui": "playwright test --ui"
  }
}
```

## 監控與分析

### 性能監控

```typescript
// 性能監控 Hook
const usePerformanceMonitoring = () => {
  useEffect(() => {
    // Core Web Vitals 監控
    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {
      getCLS(console.log);
      getFID(console.log);
      getFCP(console.log);
      getLCP(console.log);
      getTTFB(console.log);
    });
    
    // 自定義性能指標
    const observer = new PerformanceObserver((list) => {
      for (const entry of list.getEntries()) {
        if (entry.entryType === 'navigation') {
          console.log('Page Load Time:', entry.duration);
        }
      }
    });
    
    observer.observe({ entryTypes: ['navigation', 'paint'] });
    
    return () => observer.disconnect();
  }, []);
};
```

### 錯誤追蹤

```typescript
// 錯誤邊界組件
class ErrorBoundary extends React.Component<
  { children: React.ReactNode },
  { hasError: boolean; error?: Error }
> {
  constructor(props: { children: React.ReactNode }) {
    super(props);
    this.state = { hasError: false };
  }
  
  static getDerivedStateFromError(error: Error) {
    return { hasError: true, error };
  }
  
  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {
    console.error('Error caught by boundary:', error, errorInfo);
    // 發送錯誤報告到監控服務
  }
  
  render() {
    if (this.state.hasError) {
      return (
        <div className="flex items-center justify-center h-screen">
          <div className="text-center">
            <h2 className="text-2xl font-bold mb-4">出現錯誤</h2>
            <p className="text-muted-foreground mb-4">
              應用程式遇到未預期的錯誤，請重新整理頁面或聯繫技術支援。
            </p>
            <button
              onClick={() => window.location.reload()}
              className="px-4 py-2 bg-primary text-primary-foreground rounded-md"
            >
              重新整理頁面
            </button>
          </div>
        </div>
      );
    }
    
    return this.props.children;
  }
}
```

## 總結

本設計規劃說明書提供了代理管理系統前端的完整設計方案，包括：

1. **現代化的 VS Code 風格界面**: 採用五區域佈局，提供熟悉的開發者體驗
2. **響應式設計**: 支援各種裝置尺寸，確保最佳使用體驗
3. **完整的功能模組**: 涵蓋代理管理、任務調度、數據分析等核心功能
4. **高性能優化**: 代碼分割、虛擬化列表、圖片優化等技術
5. **可訪問性支援**: 遵循 WCAG 標準，支援鍵盤導航和螢幕閱讀器
6. **國際化支援**: 多語言界面，支援全球化部署
7. **完善的測試策略**: 單元測試、整合測試和 E2E 測試
8. **現代化的開發工具鏈**: TypeScript、Vite、Tailwind CSS 等

這個設計方案為開發團隊提供了清晰的實施路線圖，確保能夠建構出高品質、易維護的前端應用程式。