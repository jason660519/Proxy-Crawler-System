# 代理管理系統前端建置指南

## 專案概述

本文檔為代理爬蟲管理系統的前端建置指南，專注於實用的技術實現和開發流程。

### 核心目標
- 提供直觀的代理池管理界面
- 實現即時的代理狀態監控
- 支援爬蟲任務的配置與調度
- 展示代理品質分析與統計

## 技術架構

### 前端技術棧
```yaml
核心框架:
  - React 18+ (函數式組件 + Hooks)
  - TypeScript 5+ (強型別支援)
  - Vite (快速建置工具)

UI 框架:
  - Ant Design 5+ (企業級 UI 組件庫)
  - Styled Components (CSS-in-JS)
  - React Router 6+ (路由管理)

狀態管理:
  - Zustand (輕量級狀態管理)
  - React Query (伺服器狀態管理)

資料視覺化:
  - ECharts (圖表庫)
  - React-ECharts (React 整合)

開發工具:
  - ESLint + Prettier (代碼規範)
  - Vitest (單元測試)
  - TypeScript (型別檢查)
```

### VS Code 風格界面設計

#### 整體布局結構
```
┌─────────────────────────────────────────────────────────┐
│ Title Bar (30px)                                       │
├─────────────────────────────────────────────────────────┤
│ Menu Bar (30px)                                        │
├──────┬──────────────────────────────────────────────────┤
│      │ Editor Area                                      │
│ Act  │ ┌─────────────────┬─────────────────────────────┐ │
│ Bar  │ │ Tab Bar         │ Side Panel                  │ │
│ (50) │ ├─────────────────┼─────────────────────────────┤ │
│      │ │ Main Content    │ Properties Panel            │ │
│      │ │                 │                             │ │
├──────┼─────────────────┴─────────────────────────────┤ │
│ Side │ Status Bar (22px)                              │ │
│ Bar  │                                                │ │
└──────┴────────────────────────────────────────────────┘
```

#### 核心頁面規劃

**1. 代理池管理頁面**
- 代理列表展示（表格形式）
- 即時狀態指示器
- 批量操作功能
- 搜尋與篩選

**2. 品質分析頁面**
- 代理性能圖表
- 地理分佈地圖
- 成功率統計
- 響應時間分析

**3. 任務調度頁面**
- 爬蟲任務配置
- 執行狀態監控
- 日誌查看
- 排程管理

**4. 系統設定頁面**
- 代理來源配置
- 檢測參數設定
- 通知設定
- 使用者偏好

## 開發環境建置

### 前置需求
```bash
# Node.js 版本要求
node >= 18.0.0
npm >= 9.0.0
# 或使用 pnpm
pnpm >= 8.0.0
```

### 專案初始化
```bash
# 1. 創建 React + TypeScript 專案
npm create vite@latest proxy-admin-frontend -- --template react-ts
cd proxy-admin-frontend

# 2. 安裝核心依賴
npm install antd @ant-design/icons
npm install zustand @tanstack/react-query
npm install echarts echarts-for-react
npm install react-router-dom
npm install styled-components
npm install @types/styled-components

# 3. 安裝開發依賴
npm install -D @types/node
npm install -D eslint @typescript-eslint/eslint-plugin
npm install -D prettier eslint-config-prettier
npm install -D vitest @testing-library/react
```

### 專案結構
```
src/
├── components/          # 共用組件
│   ├── Layout/         # 布局組件
│   ├── ProxyTable/     # 代理表格
│   ├── Charts/         # 圖表組件
│   └── Common/         # 通用組件
├── pages/              # 頁面組件
│   ├── ProxyPool/      # 代理池管理
│   ├── Analytics/      # 品質分析
│   ├── Tasks/          # 任務調度
│   └── Settings/       # 系統設定
├── hooks/              # 自定義 Hooks
├── stores/             # 狀態管理
├── services/           # API 服務
├── types/              # TypeScript 型別定義
├── utils/              # 工具函數
└── styles/             # 樣式文件
```

## 核心功能實現

### 1. 代理狀態管理
```typescript
// stores/proxyStore.ts
import { create } from 'zustand'

interface ProxyNode {
  id: string
  ip: string
  port: number
  protocol: 'http' | 'https' | 'socks4' | 'socks5'
  status: 'active' | 'inactive' | 'testing'
  responseTime: number
  successRate: number
  location: string
  lastChecked: Date
}

interface ProxyStore {
  proxies: ProxyNode[]
  loading: boolean
  fetchProxies: () => Promise<void>
  updateProxyStatus: (id: string, status: ProxyNode['status']) => void
}

export const useProxyStore = create<ProxyStore>((set, get) => ({
  proxies: [],
  loading: false,
  fetchProxies: async () => {
    set({ loading: true })
    try {
      const response = await fetch('/api/proxies')
      const proxies = await response.json()
      set({ proxies, loading: false })
    } catch (error) {
      console.error('Failed to fetch proxies:', error)
      set({ loading: false })
    }
  },
  updateProxyStatus: (id, status) => {
    const proxies = get().proxies.map(proxy => 
      proxy.id === id ? { ...proxy, status } : proxy
    )
    set({ proxies })
  }
}))
```

### 2. API 服務層
```typescript
// services/api.ts
const API_BASE_URL = 'http://localhost:8000'

export class ApiService {
  static async getProxies(): Promise<ProxyNode[]> {
    const response = await fetch(`${API_BASE_URL}/api/proxies`)
    if (!response.ok) {
      throw new Error('Failed to fetch proxies')
    }
    return response.json()
  }

  static async testProxy(proxyId: string): Promise<boolean> {
    const response = await fetch(`${API_BASE_URL}/api/proxies/${proxyId}/test`, {
      method: 'POST'
    })
    return response.ok
  }

  static async getAnalytics(): Promise<AnalyticsData> {
    const response = await fetch(`${API_BASE_URL}/api/analytics`)
    return response.json()
  }
}
```

## 建置與部署

### 開發模式
```bash
# 啟動開發伺服器
npm run dev

# 執行測試
npm run test

# 代碼檢查
npm run lint
```

### 生產建置
```bash
# 建置生產版本
npm run build

# 預覽建置結果
npm run preview
```

### 部署配置
```yaml
# .github/workflows/deploy.yml
name: Deploy Frontend

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
      - run: npm ci
      - run: npm run build
      - run: npm run test
```

## 開發指南

### 代碼規範
- 使用 TypeScript 嚴格模式
- 遵循 ESLint 規則
- 組件使用函數式寫法
- 自定義 Hook 以 `use` 開頭
- 檔案命名使用 PascalCase（組件）或 camelCase（工具）

### 效能優化
- 使用 React.memo 避免不必要的重渲染
- 實現虛擬列表處理大量代理數據
- 使用 React Query 進行資料快取
- 代碼分割與懶載入

### 測試策略
- 單元測試：組件邏輯測試
- 整合測試：API 服務測試
- E2E 測試：關鍵流程測試

## 後續擴展

### 短期目標（1-2 週）
- [ ] 完成基礎布局組件
- [ ] 實現代理列表頁面
- [ ] 整合後端 API

### 中期目標（1-2 月）
- [ ] 完成所有核心頁面
- [ ] 實現即時數據更新
- [ ] 添加圖表視覺化

### 長期目標（3-6 月）
- [ ] 完善 VS Code 風格界面
- [ ] 實現進階分析功能
- [ ] 支援多語言國際化

---

**注意事項：**
- 本指南專注於實際開發需求
- 技術選型基於專案現狀
- 建議循序漸進實施
- 保持代碼品質與可維護性